{"ast":null,"code":"var _jsxFileName = \"/Users/sylviayu/Desktop/project/create-vinyl-record/src/Canvas.js\";\nimport React, { useRef, useEffect, useState } from 'react'; // import AudioPlayer from \"./audio/AudioPlayer\";\n//Data fields\n\nconst inc = 5;\n\nconst getPixelRatio = context => {\n  var backingStore = context.backingStorePixelRatio || context.webkitBackingStorePixelRatio || context.mozBackingStorePixelRatio || context.msBackingStorePixelRatio || context.oBackingStorePixelRatio || context.backingStorePixelRatio || 1;\n  return (window.devicePixelRatio || 1) / backingStore;\n}; //sound  \n\n\nconst convertHexToRGBA = (hexCode, opacity) => {\n  // console.log(\"=\"* 20)\n  // console.log(opacity)\n  const hex = hexCode.replace('#', '');\n  const r = parseInt(hex.substring(0, 2), 16);\n  const g = parseInt(hex.substring(2, 4), 16);\n  const b = parseInt(hex.substring(4, 6), 16);\n  return `rgba(${r},${g},${b},${opacity / 100})`;\n}; //start of function\n\n\nconst Canvas = props => {\n  const {\n    keycode,\n    setKey,\n    allData,\n    setAllData,\n    scale\n  } = props;\n  const [Datas, setDatas] = useState(allData[scale]);\n  const canvasRef = useRef(null);\n\n  const draw = (ctx, frameCount) => {\n    let new_data = {};\n    Object.keys(allData).forEach(ind => {\n      if (ind == scale) {\n        for (let i = 0; i < allData[ind].length; i++) {\n          let item = allData[ind][i];\n\n          if (item.key.localeCompare(keycode) == 0) {\n            item.opa += inc;\n            item.col_display = convertHexToRGBA(item.col_origin, item.opa);\n          } else {\n            continue;\n          }\n        } // console.log()\n\n\n        new_data[ind] = allData[ind]; // console.log(allData[ind])\n      } else {\n        new_data[ind] = allData[ind];\n      }\n    });\n    setAllData(new_data); // console.log(new_data)\n\n    Object.entries(allData).forEach(entry => {\n      const [key, value] = entry;\n      value.forEach((item, index) => {\n        ctx.beginPath();\n        ctx.lineWidth = 20; // console.log(\"change\")\n        // console.log(item.opa)\n\n        ctx.strokeStyle = item.col_display;\n        let count = 12; // console.log(item.col_display)\n\n        let part = 2 * Math.PI / count;\n        let start = index * part;\n        let radius = key * 60;\n        ctx.arc(350, 350, radius, start, part + start);\n        ctx.stroke();\n      });\n    }); // Object.entries(chords).forEach(entry => {\n    //   const [key, value] = entry;\n    //   value.forEach((item, index) => {\n    //     ctx.beginPath(); \n    //     ctx.lineWidth = 15;\n    //     // console.log(\"change\")\n    //     // console.log(item.opa)\n    //     ctx.strokeStyle = item.col_display\n    //     let count = 12\n    //     // console.log(item.col_display)\n    //     let part = 2*Math.PI / count\n    //     let start = index* part\n    //     let radius = key* 76 - (key-1) * 16\n    //     ctx.arc(350, 350, radius, start, part+start)\n    //     ctx.stroke()\n    //   })\n    // });\n\n    setKey('');\n  }; //   useEffect(() => {\n  //   audioPlayer.setInstrument(\"acoustic_grand_piano\");\n  // }, []);\n  // useEffect(() =>{ \n  //   Datas.forEach((item, index) => {\n  //     // let snd  = new Audio();\n  //     // src  = document.createElement(\"source\");\n  //     // src.type = \"audio/wav\";\n  //     let mus = item.pitch\n  //     console.log(item.pitch)\n  //     // if (mus.includes(\"#\")){\n  //     //   let ind = mus.indexOf(\"#\")\n  //     //   mus = mus.slice(0,ind) +\"%23\" +mus.slice(ind+1,mus.length)\n  //     // }\n  //     // src.src  = \"guitar/Crispy Clean Strat/Crispy Clean Strat Samples/Cripsy Clean Strat - \"+muc+\".wav\"\n  //     // snd.appendChild(src);\n  //   })\n  // }, [])\n\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext('2d');\n    let frameCount = 0;\n    let animationFrameId; /////////\n\n    let ratio = getPixelRatio(context);\n    let width = window.getComputedStyle(canvas).getPropertyValue('width').slice(0, -2);\n    let height = getComputedStyle(canvas).getPropertyValue('height').slice(0, -2); // console.log(width, height)\n\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`; //////////\n\n    draw(context, frameCount); // audioPlayer.playNote(\"C4\")\n    // const render = () => {\n    //   frameCount++\n    //   draw(context, frameCount, keycode)\n    //   animationFrameId = window.requestAnimationFrame(render)\n    // }\n    // render()\n    // return () => {\n    //   window.cancelAnimationFrame(animationFrameId)\n    // }\n  }, [keycode]);\n  return /*#__PURE__*/React.createElement(\"canvas\", {\n    ref: canvasRef,\n    style: {\n      width: window.innerWidth,\n      height: window.innerHeigh\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 10\n    }\n  });\n};\n\nexport default Canvas;","map":{"version":3,"sources":["/Users/sylviayu/Desktop/project/create-vinyl-record/src/Canvas.js"],"names":["React","useRef","useEffect","useState","inc","getPixelRatio","context","backingStore","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","window","devicePixelRatio","convertHexToRGBA","hexCode","opacity","hex","replace","r","parseInt","substring","g","b","Canvas","props","keycode","setKey","allData","setAllData","scale","Datas","setDatas","canvasRef","draw","ctx","frameCount","new_data","Object","keys","forEach","ind","i","length","item","key","localeCompare","opa","col_display","col_origin","entries","entry","value","index","beginPath","lineWidth","strokeStyle","count","part","Math","PI","start","radius","arc","stroke","canvas","current","getContext","animationFrameId","ratio","width","getComputedStyle","getPropertyValue","slice","height","style","innerWidth","innerHeigh"],"mappings":"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","sourcesContent":["\nimport React, { useRef, useEffect, useState } from 'react'\n// import AudioPlayer from \"./audio/AudioPlayer\";\n\n\n//Data fields\nconst inc = 5\n\n\n\nconst getPixelRatio = context => {\n  var backingStore =\n  context.backingStorePixelRatio ||\n  context.webkitBackingStorePixelRatio ||\n  context.mozBackingStorePixelRatio ||\n  context.msBackingStorePixelRatio ||\n  context.oBackingStorePixelRatio ||\n  context.backingStorePixelRatio ||\n  1;\n  \n  return (window.devicePixelRatio || 1) / backingStore;\n};\n\n\n//sound  \nconst convertHexToRGBA = (hexCode, opacity) => {\n  // console.log(\"=\"* 20)\n  // console.log(opacity)\n  const hex = hexCode.replace('#', ''); \n  \n  const r = parseInt(hex.substring(0, 2), 16);\n  const g = parseInt(hex.substring(2, 4), 16);\n  const b = parseInt(hex.substring(4, 6), 16);\n\n  return `rgba(${r},${g},${b},${opacity / 100})`;\n};\n\n\n\n\n//start of function\nconst Canvas = props=> {\n  const { keycode, setKey, allData, setAllData, scale } = props\n  const [Datas, setDatas] = useState(allData[scale]);\n  const canvasRef = useRef(null)\n\n  \n\n  const draw = (ctx, frameCount) => {\n    let new_data = {}\n    Object.keys(allData).forEach(ind => {\n      if (ind == scale){\n        for (let i = 0; i < allData[ind].length; i++){\n          let item = allData[ind][i]\n          if (item.key.localeCompare(keycode) == 0){\n            item.opa += inc\n            item.col_display = convertHexToRGBA(item.col_origin, item.opa)\n            \n          }\n          else{\n            continue;\n          }\n\n        }\n        // console.log()\n        new_data[ind] = allData[ind]\n        // console.log(allData[ind])\n     }else{\n       \n       new_data[ind] = allData[ind]\n       \n     }\n    })\n\n    setAllData(new_data)\n    // console.log(new_data)\n  \n    \n    Object.entries(allData).forEach(entry => {\n      const [key, value] = entry;\n      value.forEach((item, index) => {\n        ctx.beginPath(); \n        ctx.lineWidth = 20;\n        // console.log(\"change\")\n        // console.log(item.opa)\n        ctx.strokeStyle = item.col_display\n        let count = 12\n        // console.log(item.col_display)\n        let part = 2*Math.PI / count\n        let start = index* part\n        let radius = key* 60\n        ctx.arc(350, 350, radius, start, part+start)\n        ctx.stroke()\n      \n      })\n    });\n\n    // Object.entries(chords).forEach(entry => {\n    //   const [key, value] = entry;\n    //   value.forEach((item, index) => {\n    //     ctx.beginPath(); \n    //     ctx.lineWidth = 15;\n    //     // console.log(\"change\")\n    //     // console.log(item.opa)\n    //     ctx.strokeStyle = item.col_display\n    //     let count = 12\n    //     // console.log(item.col_display)\n    //     let part = 2*Math.PI / count\n    //     let start = index* part\n    //     let radius = key* 76 - (key-1) * 16\n    //     ctx.arc(350, 350, radius, start, part+start)\n    //     ctx.stroke()\n      \n    //   })\n    // });\n\n\n    setKey('')\n    \n  }\n\n\n  //   useEffect(() => {\n  //   audioPlayer.setInstrument(\"acoustic_grand_piano\");\n  // }, []);\n  // useEffect(() =>{ \n  \n  //   Datas.forEach((item, index) => {\n  //     // let snd  = new Audio();\n  //     // src  = document.createElement(\"source\");\n  //     // src.type = \"audio/wav\";\n  //     let mus = item.pitch\n  //     console.log(item.pitch)\n  //     // if (mus.includes(\"#\")){\n  //     //   let ind = mus.indexOf(\"#\")\n  //     //   mus = mus.slice(0,ind) +\"%23\" +mus.slice(ind+1,mus.length)\n  //     // }\n  //     // src.src  = \"guitar/Crispy Clean Strat/Crispy Clean Strat Samples/Cripsy Clean Strat - \"+muc+\".wav\"\n  //     // snd.appendChild(src);\n  //   })\n    \n\n  // }, [])\n\n\n  \n  useEffect(() => {\n    \n    const canvas = canvasRef.current\n    const context = canvas.getContext('2d')\n    let frameCount = 0\n    let animationFrameId\n\n\n\n    /////////\n    let ratio = getPixelRatio(context);\n    let width = window.getComputedStyle(canvas)\n        .getPropertyValue('width')\n        .slice(0, -2);\n    let height = getComputedStyle(canvas)\n        .getPropertyValue('height')\n       .slice(0, -2);\n    // console.log(width, height)\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    \n\n\n    //////////\n    draw(context, frameCount)\n    // audioPlayer.playNote(\"C4\")\n    // const render = () => {\n    //   frameCount++\n    //   draw(context, frameCount, keycode)\n    //   animationFrameId = window.requestAnimationFrame(render)\n    // }\n    // render()\n    \n    // return () => {\n    //   window.cancelAnimationFrame(animationFrameId)\n    // }\n  }, [keycode])\n  \n  return <canvas ref={canvasRef} style={{ width: window.innerWidth, height: window.innerHeigh}}/>\n}\n\nexport default Canvas"]},"metadata":{},"sourceType":"module"}